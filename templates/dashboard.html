<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TurboTrader-AI Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        header h1 {
            font-size: 28px;
            font-weight: bold;
        }
        
        .status {
            display: flex;
            gap: 20px;
            align-items: center;
        }
        
        .status-badge {
            background: rgba(255,255,255,0.2);
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .status-badge.running {
            background: #4caf50;
        }
        
        .status-badge.stopped {
            background: #f44336;
        }
        
        .controls {
            padding: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            background: #f5f5f5;
        }
        
        .card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .card h3 {
            margin-bottom: 15px;
            color: #667eea;
            font-size: 18px;
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
            width: 100%;
            margin: 10px 0;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102,126,234,0.4);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .data-display {
            padding: 30px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .data-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 5px solid #667eea;
        }
        
        .data-card h4 {
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .value {
            font-size: 24px;
            font-weight: bold;
            color: #333;
            margin: 10px 0;
        }
        
        .value.positive {
            color: #4caf50;
        }
        
        .value.negative {
            color: #f44336;
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }
        
        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .table th {
            background: #667eea;
            color: white;
        }
        
        .table tr:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ü§ñ TurboTrader-AI Dashboard</h1>
            <div class="status">
                <span class="status-badge" id="status-badge">OFFLINE</span>
                <span id="balance-display">Balance: $0.00</span>
            </div>
        </header>
        
        <div class="controls">
            <div class="card">
                <h3>üéÆ Kontroller</h3>
                <button onclick="startBot()">‚ñ∂Ô∏è BA≈ûLA</button>
                <button onclick="stopBot()" style="background: #f44336;">‚èπÔ∏è DURDUR</button>
                <button onclick="refreshStatus()">üîÑ G√úNCELLE</button>
            </div>
            
            <div class="card">
                <h3>üìä Analiz</h3>
                <input type="text" id="coin-input" placeholder="BTC, ETH, vb..." value="BTC">
                <button onclick="analyzeCoin()">üîç ANALƒ∞Z YAP</button>
            </div>
            
            <div class="card">
                <h3>üí∞ Manuel ƒ∞≈ülem</h3>
                <input type="text" id="trade-symbol" placeholder="BTCUSDT">
                <input type="number" id="trade-qty" placeholder="Miktar" step="0.001" value="0.01">
                <button onclick="manualBuy()" style="background: #4caf50;">üü¢ AL</button>
                <button onclick="manualSell()" style="background: #f44336;">üî¥ SAT</button>
            </div>
        </div>
        
        <div class="data-display">
            <div class="data-card">
                <h4>Hesap Bilgisi</h4>
                <p>USDT Bakiye:</p>
                <div class="value" id="balance">$0.00</div>
                <p>A√ßƒ±k Pozisyonlar:</p>
                <div class="value" id="positions">0</div>
                <p>Toplam P&L:</p>
                <div class="value positive" id="pnl">$0.00</div>
            </div>
            
            <div class="data-card">
                <h4>Bot Durumu</h4>
                <p>Durum:</p>
                <div class="value" id="bot-status">KAPALI</div>
                <p>Aktif Coinler:</p>
                <div class="value" id="active-coins">-</div>
                <p>Son G√ºncelleme:</p>
                <div style="font-size: 12px;" id="last-update">-</div>
            </div>
            
            <div class="data-card">
                <h4>Analiz Sonu√ßlarƒ±</h4>
                <p>1H Skoru:</p>
                <div class="value" id="score-1h">-</div>
                <p>4H Skoru:</p>
                <div class="value" id="score-4h">-</div>
                <p>1D Skoru:</p>
                <div class="value" id="score-1d">-</div>
            </div>
        </div>
        
        <div style="padding: 30px;">
            <h3>Son ƒ∞≈ülemler</h3>
            <table class="table">
                <thead>
                    <tr>
                        <th>Zaman</th>
                        <th>Coin</th>
                        <th>Tip</th>
                        <th>Fiyat</th>
                        <th>Miktar</th>
                        <th>P&L</th>
                    </tr>
                </thead>
                <tbody id="trades-list">
                    <tr><td colspan="6" style="text-align: center; color: #999;">ƒ∞≈ülem yok</td></tr>
                </tbody>
            </table>
        </div>
    </div>
    
    <script>
        const API_URL = '/api';
        let botRunning = false;
        
        async function startBot() {
            const coins = ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'ADAUSDT', 'SOLUSDT'];
            const response = await fetch(`${API_URL}/start`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({coins})
            });
            const data = await response.json();
            alert('Bot ba≈ülatƒ±ldƒ±: ' + data.coins.join(', '));
            botRunning = true;
            refreshStatus();
        }
        
        async function stopBot() {
            const response = await fetch(`${API_URL}/stop`, {method: 'POST'});
            const data = await response.json();
            alert('Bot durduruldu. Kapatƒ±lan pozisyonlar: ' + data.closed_positions);
            botRunning = false;
            refreshStatus();
        }
        
        async function refreshStatus() {
            const response = await fetch(`${API_URL}/status`);
            const data = await response.json();
            
            document.getElementById('balance').textContent = `$${data.balance.toFixed(2)}`;
            document.getElementById('balance-display').textContent = `Balance: $${data.balance.toFixed(2)}`;
            document.getElementById('positions').textContent = Object.keys(data.positions).length;
            document.getElementById('bot-status').textContent = data.status;
            document.getElementById('active-coins').textContent = data.active_coins.join(', ') || '-';
            document.getElementById('last-update').textContent = new Date(data.last_update).toLocaleString('tr-TR');
            
            const badge = document.getElementById('status-badge');
            badge.textContent = data.running ? '√áALI≈ûIYOR' : 'KAPALI';
            badge.className = 'status-badge ' + (data.running ? 'running' : 'stopped');
        }
        
        async function analyzeCoin() {
            const coin = document.getElementById('coin-input').value.toUpperCase();
            if (!coin) return alert('Coin adƒ± girin');
            
            const response = await fetch(`${API_URL}/analyze/${coin}`);
            const scores = await response.json();
            
            if (scores.error) return alert('Hata: ' + scores.error);
            
            if (scores['1h']) document.getElementById('score-1h').textContent = scores['1h'].score.toFixed(2);
            if (scores['4h']) document.getElementById('score-4h').textContent = scores['4h'].score.toFixed(2);
            if (scores['1d']) document.getElementById('score-1d').textContent = scores['1d'].score.toFixed(2);
        }
        
        async function manualBuy() {
            const symbol = document.getElementById('trade-symbol').value;
            const qty = document.getElementById('trade-qty').value;
            if (!symbol || !qty) return alert('Symbol ve miktarƒ± girin');
            
            const response = await fetch(`${API_URL}/buy`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({symbol, quantity: parseFloat(qty)})
            });
            const data = await response.json();
            alert(data.status === 'success' ? '‚úÖ AL i≈ülemi ba≈üarƒ±lƒ±' : '‚ùå Hata: ' + data.error);
            refreshStatus();
        }
        
        async function manualSell() {
            const symbol = document.getElementById('trade-symbol').value;
            const qty = document.getElementById('trade-qty').value;
            if (!symbol || !qty) return alert('Symbol ve miktarƒ± girin');
            
            const response = await fetch(`${API_URL}/sell`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({symbol, quantity: parseFloat(qty)})
            });
            const data = await response.json();
            alert(data.status === 'success' ? '‚úÖ SAT i≈ülemi ba≈üarƒ±lƒ±' : '‚ùå Hata: ' + data.error);
            refreshStatus();
        }
        
        // Otomatik g√ºncelle
        refreshStatus();
        setInterval(refreshStatus, 10000); // 10 sn'de bir g√ºncelle
    </script>
</body>
</html>
